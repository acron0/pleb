---
phase: 01-foundation
plan: 01
type: execute
---

<objective>
Initialize Rust project with CLI structure using clap.

Purpose: Establish the project foundation that all other phases build upon.
Output: Bootable `pleb` CLI with subcommand routing (watch, list, attach).
</objective>

<execution_context>
@~/.claude/plugins/cache/taches-cc-resources/taches-cc-resources/1.0.0/skills/create-plans/workflows/execute-phase.md
@~/.claude/plugins/cache/taches-cc-resources/taches-cc-resources/1.0.0/skills/create-plans/templates/summary.md
</execution_context>

<context>
@.planning/BRIEF.md
@.planning/ROADMAP.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Initialize Rust project with dependencies</name>
  <files>Cargo.toml, src/main.rs, .gitignore</files>
  <action>
    Run `cargo init` to create project structure.

    Configure Cargo.toml with:
    - name = "pleb"
    - edition = "2021"

    Dependencies:
    - clap = { version = "4", features = ["derive"] } - CLI parsing
    - tokio = { version = "1", features = ["full"] } - async runtime
    - serde = { version = "1", features = ["derive"] } - serialization
    - toml = "0.8" - config file parsing
    - anyhow = "1" - error handling
    - tracing = "0.1" - logging
    - tracing-subscriber = { version = "0.3", features = ["env-filter"] } - log output

    Create .gitignore with standard Rust ignores (target/, Cargo.lock for binaries is optional but include it).

    In src/main.rs, create minimal async main with tokio::main and tracing initialization.
  </action>
  <verify>cargo build succeeds without errors</verify>
  <done>Project compiles, `cargo run` executes without panic</done>
</task>

<task type="auto">
  <name>Task 2: Create CLI structure with clap subcommands</name>
  <files>src/main.rs, src/cli.rs</files>
  <action>
    Create src/cli.rs with clap derive-based CLI structure:

    Main command: `pleb`
    Subcommands:
    - `watch` - Start watching for issues (will be implemented in Phase 4)
    - `list` - List active sessions (will be implemented in Phase 3)
    - `attach <session>` - Attach to a tmux session (will be implemented in Phase 3)

    Each subcommand should be a struct with #[derive(Parser)] or #[derive(Args)].
    Use #[command(about = "...")] for descriptions.

    In main.rs:
    - Parse CLI args
    - Match on subcommand
    - For now, each subcommand prints "Not yet implemented: {subcommand}"
    - Use anyhow::Result for error handling in main

    Structure the CLI module to be extensible - later phases will add actual implementations.

    Avoid: Don't use clap's "builder" API - use derive macros for cleaner code.
    Why: Derive API is more maintainable and type-safe.
  </action>
  <verify>
    - cargo build succeeds
    - `cargo run -- --help` shows pleb with subcommands
    - `cargo run -- watch` prints "Not yet implemented: watch"
    - `cargo run -- list` prints "Not yet implemented: list"
    - `cargo run -- attach test` prints "Not yet implemented: attach"
  </verify>
  <done>CLI parses all subcommands, help text displays correctly, placeholder messages for each command</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `cargo build --release` succeeds without errors or warnings
- [ ] `cargo clippy` passes (install if needed: `rustup component add clippy`)
- [ ] `cargo run -- --help` displays usage with all subcommands
- [ ] Each subcommand executes without panic
</verification>

<success_criteria>
- All tasks completed
- All verification checks pass
- No compiler warnings
- CLI structure ready for config integration in next plan
</success_criteria>

<output>
After completion, create `.planning/phases/01-foundation/01-01-SUMMARY.md`:

# Phase 1 Plan 1: Project Scaffold & CLI Summary

**[One-liner describing what shipped]**

## Accomplishments
- [Key outcomes]

## Files Created/Modified
- `Cargo.toml` - Project manifest with dependencies
- `src/main.rs` - Entry point with async runtime
- `src/cli.rs` - CLI structure with subcommands
- `.gitignore` - Standard Rust ignores

## Decisions Made
[Any decisions made during implementation]

## Issues Encountered
[Problems and resolutions, or "None"]

## Next Step
Ready for 01-02-PLAN.md (Config System)
</output>
