---
phase: 02-github-integration
plan: 01
type: execute
---

<objective>
Create GitHub API client with authentication and extend config for prompts.

Purpose: Establish GitHub connectivity that all issue watching and label management depends on.
Output: Working GitHub client with verified auth, plus config structure for prompt templates.
</objective>

<execution_context>
@~/.claude/plugins/cache/taches-cc-resources/taches-cc-resources/1.0.0/skills/create-plans/workflows/execute-phase.md
@~/.claude/plugins/cache/taches-cc-resources/taches-cc-resources/1.0.0/skills/create-plans/templates/summary.md
</execution_context>

<context>
@.planning/BRIEF.md
@.planning/ROADMAP.md
@.planning/phases/01-foundation/01-02-SUMMARY.md
@src/config.rs
@src/main.rs
@Cargo.toml
</context>

<tasks>

<task type="auto">
  <name>Task 1: Extend config for prompts and polling</name>
  <files>src/config.rs, pleb.example.toml</files>
  <action>
    Add to Config struct:

    ```rust
    PromptsConfig {
      dir: PathBuf,           // default: "./prompts"
      new_issue: String,      // default: "new_issue.md"
      planning_done: String,  // default: "planning_done.md"
      // Add more prompt types as needed
    }
    ```

    Add polling config to a new WatchConfig section:
    ```rust
    WatchConfig {
      poll_interval_secs: u64,  // default: 5
    }
    ```

    Update Config struct to include:
    - `prompts: PromptsConfig`
    - `watch: WatchConfig`

    Update pleb.example.toml with new sections and documentation.

    Avoid: Don't put prompts config under [paths] - give it its own [prompts] section.
    Why: Clearer separation of concerns, prompts config will grow.
  </action>
  <verify>
    - cargo build succeeds
    - pleb.example.toml parses correctly
    - `cargo run -- config show` displays new prompts and watch sections
  </verify>
  <done>Config extended with prompts and watch sections, example updated</done>
</task>

<task type="auto">
  <name>Task 2: Add octocrab and create GitHub client module</name>
  <files>Cargo.toml, src/github.rs, src/main.rs</files>
  <action>
    Add dependency to Cargo.toml:
    - octocrab = "0.41" (or latest stable)

    Create src/github.rs with:

    ```rust
    pub struct GitHubClient {
      client: octocrab::Octocrab,
      owner: String,
      repo: String,
    }

    impl GitHubClient {
      pub async fn new(config: &GithubConfig) -> Result<Self> {
        // Read token from env var specified in config.token_env
        // Create octocrab instance with personal token auth
        // Store owner/repo for later use
      }

      pub async fn verify_connection(&self) -> Result<()> {
        // Fetch repo info to verify token works
        // Return error if auth fails or repo not found
      }
    }
    ```

    Add `mod github;` to main.rs.

    Avoid: Don't hardcode the token - always read from env var specified in config.
    Why: Flexibility and security - users choose their own env var name.
  </action>
  <verify>
    - cargo build succeeds
    - No compiler warnings about unused code (add #[allow(dead_code)] temporarily if needed)
  </verify>
  <done>GitHub client module created with octocrab, compiles without errors</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `cargo build --release` succeeds without errors
- [ ] `cargo clippy` passes
- [ ] Config shows new prompts and watch sections
- [ ] pleb.example.toml documents all new options
- [ ] GitHub client module compiles
</verification>

<success_criteria>
- All tasks completed
- All verification checks pass
- No compiler warnings
- Config ready for prompt templates (Phase 4)
- GitHub client ready for issue fetching (Plan 02-02)
</success_criteria>

<output>
After completion, create `.planning/phases/02-github-integration/02-01-SUMMARY.md`:

# Phase 2 Plan 1: GitHub API Client Summary

**[One-liner describing what shipped]**

## Accomplishments
- [Key outcomes]

## Files Created/Modified
- `src/config.rs` - Added PromptsConfig and WatchConfig
- `src/github.rs` - GitHub client with octocrab
- `Cargo.toml` - Added octocrab dependency
- `pleb.example.toml` - New config sections documented

## Decisions Made
[Any decisions made during implementation]

## Issues Encountered
[Problems and resolutions, or "None"]

## Next Step
Ready for 02-02-PLAN.md (Issue Fetching)
</output>
